library(rvest)
library(httr)
library(jsonlite)
library(devtools)
library(wayback)
library(lubridate)
library(tidyverse)
library(stringr)

url = "www.businessdailyafrica.com/"
headlineDate = paste("20120717")
businessDaily = wayback_url(url, timestamp = headlineDate)
headlines = wayback_scrape(businessDaily$url, "li a")
headlines = gsub("[,]", "", headlines)
headlines = trimws(headlines, which = "both")
headlines = headlines[str_count(headlines, "\\S+") > 3]
headlines = unique(headlines)
#headlines
headlineDate = strptime(headlineDate, format = "%Y%m%d")
headlineDate = rep(headlineDate, times = length(headlines))
bdHeadlines = data.frame(headlineDate, headlines)
write.table(bdHeadlines, "Business Daily.csv", append = TRUE, col.names = FALSE, row.names = FALSE)

# dates
#daysOfWeek = NA
#timePeriod = as.data.frame(cbind(dates, daysOfWeek))
#timePeriod = mutate(timePeriod, daysOfWeek = wday(as.Date(timePeriod$dates)))
# filter to get weekdays
#weekDays = timePeriod[!(timePeriod$daysOfWeek %in% c(1,7)), "dates"]

# remove dashes from the dates
#weekDays = gsub("[-]", "", weekDays)
#weekDays

#tryDates = weekDays[1:10]
#tryDates

#compressing above code into a function
addHeadlines = function(url, dates){
 # url = "www.businessdailyafrica.com/"
#  headlineDate = paste(x)
  businessDaily = wayback_url(url, timestamp)
  if(businessDaily$url)
  headlines = wayback_scrape(businessDaily$url, "li a")
  headlines = gsub("[,]", "", headlines)
  headlines = trimws(headlines, which = "both")
  headlines = headlines[str_count(headlines, "\\S+") > 3]
  headlines = unique(headlines)
  headlines
  headlineDate = strptime(headlineDate, format = "%Y%m%d")
  headlineDate = rep(headlineDate, times = length(headlines))
  bdHeadlines = data.frame(headlineDate, headlines)
  return(bdHeadlines)
 # write.table(bdHeadlines, "Business Daily.csv", append = TRUE, col.names = FALSE, row.names = FALSE)
  }

dates = as.character(seq(from = as.Date("2017/08/07"), to = as.Date("2017/09/30"), by = 1))
dates = gsub("-", "", dates)
length(dates)
for (i in 1:length(dates)){
  #h2 headlines
  url = "www.nation.co.ke/"
  headlineDate = dates[i]
  businessDaily = wayback_url(url, timestamp = headlineDate)
  headlines = wayback_scrape(businessDaily$url, "h2 a")
  headlines = gsub("[,]", "", headlines)
  headlines = gsub("\t", "", headlines)
  headlines = gsub("\n", "", headlines)
  headlines = trimws(headlines, which = "both")
  headlines = headlines[str_count(headlines, "\\S+") > 3]
  headlines = unique(headlines)
  h2Headlines = as.data.frame(headlines)
  
  
  
  
  #h3 headlines
  url = "www.nation.co.ke/"
  headlineDate = dates[i]
  businessDaily = wayback_url(url, timestamp = headlineDate)
  headlines = wayback_scrape(businessDaily$url, "h3 a")
  headlines = gsub("[,]", "", headlines)
  headlines = gsub("\t", "", headlines)
  headlines = gsub("\n", "", headlines)
  headlines = trimws(headlines, which = "both")
  headlines = headlines[str_count(headlines, "\\S+") > 3]
  headlines = unique(headlines)
  h3Headlines = as.data.frame(headlines)
  
  #li a
headlines = wayback_scrape(businessDaily$url, "li a")
headlines = gsub("[,]", "", headlines)
headlines = gsub("\t", "", headlines)
headlines = gsub("\n", "", headlines)
headlines = trimws(headlines, which = "both")
headlines = headlines[str_count(headlines, "\\S+") > 3]
headlines = unique(headlines)
liHeadlines = as.data.frame(headlines)
headlines = rbind(h2Headlines, h3Headlines, liHeadlines)
  #return (headlines)
  headlineDate = strptime(headlineDate, format = "%Y%m%d")
  headlineDate = rep(headlineDate, times = length(headlines))
  bdHeadlines = data.frame(headlineDate, headlines)
  #print(bdHeadlines)
  write.table(bdHeadlines, "Daily Nation.csv", append = TRUE, col.names = FALSE, row.names = FALSE)
}
library(beepr)
beep("fanfare")

missingDates = c("20100802", "20100803", "20100804", "20100806", "20100807", "20100808", "20100809", "20100810", "20100813",
                 "20100814","20100815","20100816", "20100818", "20100819", "20100820", "20100821", "20100823", "20100824", "20100827",
                 "20100831", "20100902", "20100906", "20100907", "20100908", "20100910", "20100914",
                 "20100915", "20100916", "20100917", "20100920", "20100921", "20100922",  "20100923",
                 "20100924", "20100927", "20100928", "20100929", "20100930", "20101001", "20101004",
                 "20101007", "20101008", "20101011", "20101014", "20101015", "20101020", "20101021",
                 "20101022", "20101025", "20101027", "20101028", "20101029", "20111001", "20101102",
                 "20101101", "20101101", "20101101", "20101101", "20101101", "20101101", "20101101", 
                 "20101104", "20101105", "20101108", "20101109", "20101115", "20101116", "20101117",
                 "20101119", "20101123", "20101125", "20101126", "20101129", "20101207", "20101208",
                 "20101209", "20101214", "20101217", "20101220", "20101221", "20101222", "20101223",
                 "20101224", "20101227", "20101228", "20101229", "20101230", "20101231", "20110103", 
                 "20110104","20110105", "20110106", "20110107", "20110110", "20110111", "20110112", 
                 "20110113", "20110114",  "20110117", "20110118", "20110119", "20110120", "20110121",  
                  "20110124", "20110125", "20110126", "20110127", "20110131", "20110201", "20110203",
                 "20110204", "20110208", "20110209", "20110210", "20110211", "20110214", "20110215", 
                 "20110217", "20110218", "20110222", "20110224", "20110228", "20110301", "20110304",
                 "20110307", "20110309", "20110310", "20110311", "20110316", "20110317", "20110321",
                 "20110322", "20110323", "20110325", "20110328", "20110329", "20110330", "20110331", 
                 "20110401", "20110404", "20110405", "20110406", "20110407", "20110411", "20110412",
                 "20110414", "20110415", "20110418", "20110419", "20110420", "20110422", "20110425", 
                 "20110426", "20110427", "20110502", "20110503", "20110504", "20110505", "20110505",
                 "20110506", "20110509", "20110511", "20110512", "20110513", "20110516", "20110518",
                 "20110519", "20110520", "20110523", "20110524", "20110525", "20110526", "20110527",
                 "20110530", "20110531", "20110601", "20110602", "20110603", "20110606", "20110607",
                 "20110609", "20110610", "20110613", "20110614", "20110615", "20110616", "20110617",
                 "20110620", "20110621", "20110622", "20110623", "20110624", "20110627", "20110628",
                 "20110629", "20110630", "20110701", "20110702", "20110703", "20110704", "20110705",
                 "20110706", "20110707", "20110709", "20110710", "20110711", "20110825", "20110909",
                 "20110911", "20110915", "20110920", "20110926","20110930", "20111005", "20111015",
                 "20111024", "20111031", "20111005", "20111005", "20120204", "20120212", "20120403",
                 "20120405", "20120628", "20130308", "20130309", "20130310", "20130311", "20130313",
                 "20130416", "20130417", "20130628", "20130629", "20130701", "20130702", "20130704",
                 "20130706", "20130707", "20130708", "20130728", "20130729", "20130908", "20131009",
                 "20131010", "20131011", "20131012", "20131013", "20131014", "20131016", "20131017",
                 "20131018", "20131019", "20131020", "20131021", "20131022", "20131102", "20131103",
                 "20131104", "20131105", "20131112", "20140212", "20140213", "20140516", "20140518",
                 "20140519", "20140520", "20140521", "20140522", "20140523", "20140524", "20140525", 
                 "20140526", "20140527", "20140528", "20140529", "20140530", "20140531", "20140601", 
                 "20140602", "20140603", "20140604", "20140605", "20140606", "20140607", "20140608", 
                 "20140609", "20140610", "20140611", "20140612", "20140613", "20140614", "20140615",
                 "20140616", "20140617", "20140618", "20140928", "20141018", "20141104", "20141105",
                 "20141106", "20141107", "20141108", "20141109", "20141110", "20141210", "20141211", 
                 "20150130", "20150131", "20150202", "20150203", "20150204", "20150206", "20150208",
                 "20150209", "20150210", "20150211", "20150212", "20150213", "20150214", "20150215",
                 "20150218", "20150220", "20150221", "20150222", "20150224", "20150225", "20150226",
                 "20150228", "20150301", "20150303", "20150304", "20150305", "20150307", "20150308",
                 "20150415", "20150422", "20150426", "20150427", "20150428", "20150429", "20150430",
                 "20150501", "20150502", "20150503", "20150504", "20150506", "20150507", "20150508",
                 "20150509",  "20150510",  "20150511",  "20150512",  "20150513", "20150514", "20150515",
                 "20150516", "20150517",  "20150518",  "20150519",  "20150520", "20150521", "20150522",
                 "20150523", "20150524", "20150525", "20150607", "20150624", "20150626", "20150529",
                 "20150630", "20150701", "20150703", "20150704", "20150705", "20150707", "20150708",
                 "20150710", "20150711", "20150712", "20150713", "20150714", "20150715", "20150716",
                 "20150717", "20150718", "20150719", "20150720", "20150721", "20150722", "20150723",
                 "20150724", "20150725", "20150726", "20150727", "20150729", "20150730", "20150731",
                 "20150804", "20150806", "20150807", "20150808", "20150809", "20150810", "20150811",
                 "20150812", "20150816", "20150825", "20150826", "20150827", "20150828", "20150831",
                 "20150901", "20150903", "20150904", "20150905", "20150908", "20150909", "20150910",
                 "20150911", "20150912", "20150913", "20150916", "20150917", "20150919", "20150920",
                 "20150921", "20150922", "20150923", "20150924", "20150925", "20150926", "20150927",
                 "20150928", "20150929", "20151001", "20151002", "20151003", "20151004", "20151005",
                 "20151006", "20151007", "20151008", "20151009", "20151010", "20151011", "20151012",
                 "20151013", "20151014", "20151029", "20160122", "20160123", "20160124", "20160221",
                 "20160306", "20160307", "20160426", "20160427", "20160428", "20160429", "20160430",
                 "20160501", "20160502", "20160503", "20160504", "20160505", "20160507", "20160508",
                 "20160509", "20160510", "20160511", "20160513", "20160514", "20160515", "20160516",
                 "20160518", "20160519", "20160520", "20160521", "20160522", "20160523", "20160524",
                 "20160525", "20160526", "20160527", "20160529", "20160531", "20160601", "20160623",
                 "20160624", "20160625", "20160626", "20160627", "20160628", "20160629", "20160630",
                 "20160701", "20160702", "20160703", "20160704", "20160705", "20160706", "20160707",
                 "20160712", "20160713", "20160715", "20160716", "20160717", "20160718", "20160719",
                 "20160720", "20160721", "20160722", "20160723", "20160724", "20160725", "20160726",
                 "20160727", "20160728", "20160730", "20160731", "20160801", "20160802", "20160803",
                 "20160804", "20160805", "20160806", "20160807", "20160808", "20160809", "20160810",
                 "20160813", "20160915", "20160928", "20160929", "20161019", "20161020", "20161021",
                 "20161022", "20161022", "20161023", "20161024", "20161025", "20161026", "20161028",
                 "20161029", "20161030", "20161031", "20161102", "20161103", "20161104", "20161105",
                 "20161106", "20161116", "20161117", "20161220", "20161221", "20170110", "20170525",
                 "20170526", "20170604", "20170616", "20170617", "20170618", "20170619", "20170620",
                 "20170621", "20170622", "20170626", "20170627", "20170628", "20170630", "20170701",
                 "20170704", "20170705", "20170706", "20170708", "20170709", "20170710", "20170711",
                 "20170713", "20170714", "20170715", "20170716", "20170718", "20170719", "20170721",
                 "20170722", "20170723", "20170725", "20170726", "20170727", "20170728", "20170729",
                 "20170730", "20170801", "20170802", "20170803", "20170804", "20170805", "20170806",
                 "20170808", "20170809", "20170809", "20170810", "20170811", "20170812", "20170813",
                 "20170814", "20170815", "20170816", "20170817", "20170818", "20170819", "20170820",
                 "20170821", "20170823", "20170825", "20170826", "20170827", "20170828", "20170829",
                 "20170901", "20170902", "20170903", "20170904", "20170905", "20170906", "20170907",
                  "20170922", "20170923", "20170925", "20170926", "20170927", "20170928", "20170930")
                 
dates = gsub("-", "", dates)
filledDates = dates[!(dates %in% missingDates)]